@model QuanLyDangKyNgayLD.Models.SinhVien

@{
    ViewBag.Title = "Thông tin sinh viên";
    Layout = "~/Areas/Student/Views/Shared/Viewsiderbar.cshtml";
}

<div class="container mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Chỉnh sửa thông tin sinh viên</h4>
        </div>
        <div class="card-body">
            @using (Html.BeginForm("UpdateInfo", "MainSinhVien", FormMethod.Post, new { area = "Student", enctype = "multipart/form-data" }))
            {
                @Html.AntiForgeryToken()

                <!-- Hiển thị avatar hiện tại -->
                <div class="text-center mb-4">
                    <img id="avatarPreview"
                         src="@(Model.Anh != null ? Url.Content(Model.Anh.DuongDan) : Url.Content("~/image/Avarta.png"))"
                         class="rounded-circle"
                         alt="Avatar"
                         style="width:120px;height:120px;object-fit:cover;" />
                </div>

                <!-- Upload ảnh mới -->
                <div class="mb-3">
                    <label class="form-label">Ảnh đại diện</label>
                    <input type="file" name="AvatarFile" id="avatarFile" class="form-control" accept="image/*" />
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">MSSV</label>
                        @Html.TextBoxFor(m => m.MSSV, new { @class = "form-control", placeholder = "Nhập MSSV" })
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Họ và Tên</label>
                        @Html.TextBoxFor(m => m.HoTen, new { @class = "form-control", placeholder = "Nhập họ tên" })
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Email</label>
                        @Html.TextBoxFor(m => m.Email, new { @class = "form-control", placeholder = "Nhập email" })
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Số điện thoại</label>
                        @Html.TextBoxFor(m => m.SoDienThoaiSinhVien, new { @class = "form-control", placeholder = "Nhập số điện thoại" })
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Ngày sinh</label>
                        @Html.TextBoxFor(m => m.NgaySinh, "{0:yyyy-MM-dd}", new { @class = "form-control", type = "date" })
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Giới tính</label>
                        @Html.DropDownListFor(m => m.GioiTinh,
                            new SelectList(new[] { "Nam", "Nữ", "Khác" }, Model.GioiTinh),
                            "Chọn giới tính",
                            new { @class = "form-select" })
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Quê quán</label>
                    @Html.TextBoxFor(m => m.QueQuan, new { @class = "form-control", placeholder = "Nhập quê quán" })
                </div>

                <div class="d-flex justify-content-between">
                    <a href="@Url.Action("Index","MainSinhVien", new { area="Student" })" class="btn btn-secondary">
                        Quay lại
                    </a>
                    <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                </div>
            }
        </div>
    </div>
</div>

<script>
    // Preview ảnh khi chọn file
    document.getElementById("avatarFile").addEventListener("change", function (event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = e => {
                document.getElementById("avatarPreview").src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });
</script>
<script src="~/Areas/Student/Content/Js/StudentMain/StudentInfo.js"></script> 